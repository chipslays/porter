class Porter{events={porter:{},raw:{}};queue=[];options={pingInterval:3e4,maxBodySize:1e6};connected=null;disconnected=null;reconnected=null;error=null;pong;__pingInterval;raw={on:null,send:null};constructor(t,e){this.ws="string"==typeof t?new WebSocket(t):t,e&&(this.options={...this.options,...e}),this.raw.on=(t,e)=>{if("pong"==t&&"pong"in this.events.raw)throw Error('You cannot override the "pong" service event. Use `porterInstance.pong = () => {...}` instead.');return this.events.raw[t]=e,this},this.raw.send=t=>{this.ws.send(t)},this.initPingPong()}initPingPong(){this.__pingInterval?clearInterval(this.__pingInterval):this.__pingInterval=setInterval(()=>{this.raw.send("ping")},this.options.pingInterval),this.raw.on("pong",t=>{"function"==typeof this.pong&&this.pong(t)})}on(t,e){return this.events.porter[t]=e,this}send(t,e,n){if(n&&this.on(t,n),this.ws.readyState!==WebSocket.OPEN)return this.queue.push({type:t,data:e}),this;let s=JSON.stringify({type:t,data:e||{}});var i=new Blob([s]).size;return i/this.options.maxBodySize>1?(console.warn(`The event was not dispatched because the body size (${i}) exceeded the allowable value (${this.options.maxBodySize}).`),this):(this.ws.send(s),this)}close(){this.ws.close()}listen(){this.ws.onopen=()=>{this.queue.forEach(t=>{this.event(t.type,t.data)}),this.connected&&this.connected.call()},this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=t=>{try{var e=JSON.parse(t.data),n=this.events.porter[e.type]||null}catch(s){var e=t.data,n=this.events.raw[t.data]||null}"function"==typeof n&&n(e)}}remove(t){this.events.porter[t]&&delete this.events.porter[t]}clear(){this.events.porter={}}reconnect(t){this.ws=t||new WebSocket(this.ws.url),this.listen(),this.reconnected&&this.reconnected.call()}}