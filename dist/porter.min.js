class Porter{events={porter:{},raw:{}};queue=[];options={pingInterval:3e4,maxBodySize:1e6};connected=null;disconnected=null;error=null;pong;__pingInterval;raw={on:null,send:null};constructor(e,t){this.ws=e,t&&(this.options={...this.options,...t}),this.raw.on=(e,t)=>{if("pong"==e&&"pong"in this.events.raw)throw new Error('You cannot override the "pong" service event. Use `porterInstance.pong = () => {...}` instead.');return this.events.raw[e]=t,this},this.raw.send=e=>{this.ws.send(e)},this.initPingPong()}initPingPong(){this.__pingInterval?clearInterval(this.__pingInterval):this.__pingInterval=setInterval((()=>{this.raw.send("ping")}),this.options.pingInterval),this.raw.on("pong",(e=>{"function"==typeof this.pong&&this.pong(e)}))}on(e,t){return this.events.porter[e]=t,this}send(e,t,n){if(n&&this.on(e,n),this.ws.readyState!==WebSocket.OPEN)return this.queue.push({type:e,data:t}),this;let s=JSON.stringify({type:e,data:t||{}});var i=new Blob([s]).size;return i/this.options.maxBodySize>1?(console.warn(`The event was not dispatched because the body size (${i}) exceeded the allowable value (${this.options.maxBodySize}).`),this):(this.ws.send(s),this)}close(){this.ws.close()}listen(){this.ws.onopen=()=>{this.queue.forEach((e=>{this.event(e.type,e.data)})),this.connected&&this.connected.call()},this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=e=>{try{var t=JSON.parse(e.data),n=this.events.porter[t.type]||null}catch(s){t=e.data,n=this.events.raw[e.data]||null}"function"==typeof n&&n(t)}}remove(e){this.events.porter[e]&&delete this.events.porter[e]}clear(){this.events.porter={}}}