/**
 * @package Porter
 * @description An easy way to build real-time apps with a WebSocket server/client and channels.
 * @author chipslays
 * @license MIT
 * @link https://github.com/chipslays/porter
 */
 class Porter{events={};shouldSend=[];connected=null;disconnected=null;error=null;constructor(e){this.ws=e}close(){this.ws.close()}on(e,s){return this.events[e]=s,this}event(e,s,t){return t&&this.on(e,t),this.ws.readyState!==WebSocket.OPEN?(this.shouldSend.push({eventId:e,data:s}),this):(this.ws.send(JSON.stringify({eventId:e,data:s||{}})),this)}listen(){this.ws.onopen=()=>{this.shouldSend.forEach((e=>{this.event(e.eventId,e.data)})),this.connected.call()},this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=e=>{let s=JSON.parse(e.data),t=this.events[s.eventId]||null;t&&t(s)}}}