class Porter{events={};constructor(s){this.ws=s}close(){this.ws.close()}on(s,e){this.events[s]=e}event(s,e){for(;this.ws.readyState!==WebSocket.OPEN;);this.ws.send(JSON.stringify({eventId:s,data:e||{}}))}listen(){this.ws.onopen=this.connected,this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=s=>{let e=JSON.parse(s.data),t=this.events[e.eventId]||null;t&&t(e)}}}