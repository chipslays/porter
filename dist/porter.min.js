class Porter{events={};shouldSend=[];constructor(s){this.ws=s}close(){this.ws.close()}on(s,t){return this.events[s]=t,this}event(s,t){return this.ws.readyState!==WebSocket.OPEN?(this.shouldSend.push({eventId:s,data:t}),this):(this.ws.send(JSON.stringify({eventId:s,data:t||{}})),this)}listen(){this.ws.onopen=()=>{this.shouldSend.forEach((s=>{this.event(s.eventId,s.data)})),this.connected.call()},this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=s=>{let t=JSON.parse(s.data),e=this.events[t.eventId]||null;e&&e(t)}}}