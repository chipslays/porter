/**
 * @package Porter
 * @description An easy way to build real-time apps with a WebSocket server/client and channels.
 * @author chipslays
 * @license MIT
 * @link https://github.com/chipslays/porter
 */
 class Porter{events={};shouldSend=[];connected=null;disconnected=null;error=null;constructor(e){this.ws=e}on(e,s){return this.events[e]=s,this}event(e,s,t){if(t&&this.on(e,t),this.ws.readyState!==WebSocket.OPEN)return this.shouldSend.push({eventId:e,data:s}),this;let n=JSON.stringify({eventId:e,data:s||{}});return new Blob([n]).size/1e6>1?(this.close(),this):(this.ws.send(n),this)}listen(){this.ws.onopen=()=>{this.shouldSend.forEach((e=>{this.event(e.eventId,e.data)})),this.connected.call()},this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=e=>{let s=JSON.parse(e.data),t=this.events[s.eventId]||null;t&&t(s)}}close(){this.ws.close()}}