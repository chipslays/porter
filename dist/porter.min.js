class Porter{events={};shouldSend=[];constructor(s){this.ws=s}close(){this.ws.close()}on(s,e){this.events[s]=e}event(s,e){if(this.ws.readyState!==WebSocket.OPEN)return this.shouldSend.push({eventId:s,data:e});this.ws.send(JSON.stringify({eventId:s,data:e||{}}))}listen(){this.ws.onopen=()=>{this.shouldSend.forEach((s=>{this.event(s.eventId,s.data)})),this.connected.call()},this.ws.onclose=this.disconnected,this.ws.onerror=this.error,this.ws.onmessage=s=>{let e=JSON.parse(s.data),t=this.events[e.eventId]||null;t&&t(e)}}}